--- lz4.h.orig	2013-01-03 17:01:09.717241518 +0100
+++ lz4.h	2013-01-04 16:00:48.213907180 +0100
@@ -37,21 +37,37 @@
 extern "C" {
 #endif
 
-
-//**************************************
-// Compiler Options
-//**************************************
-#ifdef _MSC_VER   // Visual Studio
-#  define inline __inline           // Visual is not C99, but supports some kind of inline
+/* optional conf.h file if build with -DFASTLZ_INCLUDE_CONF_H */
+#ifdef LZ4_INCLUDE_CONF_H
+#include "conf.h"
 #endif
+#ifndef ZFASTEXTERN
+#ifdef _WIN32
+#ifdef FASTLZ_DLL
+#define ZFASTEXTERN __declspec(dllexport)
+#else
+#define ZFASTEXTERN __declspec(dllimport)
+#endif
+#else
+#define ZFASTEXTERN extern
+#endif
+#define ZFASTINLINE
+#endif
+
+/**************************************
+/ Compiler Options
+/ **************************************/
+/* #ifdef _MSC_VER   /\* Visual Studio *\/ */
+/* #  define inline __inline           /\* Visual is not C99, but supports some kind of inline *\/ */
+/* #endif */
 
 
-//****************************
-// Simple Functions
-//****************************
+/****************************
+/ Simple Functions
+/ ****************************/
 
-int LZ4_compress   (const char* source, char* dest, int isize);
-int LZ4_uncompress (const char* source, char* dest, int osize);
+ZFASTEXTERN int LZ4_compress   (const char* source, char* dest, int isize);
+ZFASTEXTERN int LZ4_uncompress (const char* source, char* dest, int osize);
 
 /*
 LZ4_compress() :
@@ -74,11 +90,11 @@
 */
 
 
-//****************************
-// Advanced Functions
-//****************************
+/****************************
+/ Advanced Functions
+/ ****************************/
 
-static inline int LZ4_compressBound(int isize)   { return ((isize) + ((isize)/255) + 16); }
+static ZFASTINLINE int LZ4_compressBound(int isize)   { return ((isize) + ((isize)/255) + 16); }
 #define           LZ4_COMPRESSBOUND(    isize)            ((isize) + ((isize)/255) + 16)
 
 /*
@@ -94,7 +110,7 @@
 */
 
 
-int LZ4_compress_limitedOutput   (const char* source, char* dest, int isize, int maxOutputSize);
+ZFASTEXTERN int LZ4_compress_limitedOutput   (const char* source, char* dest, int isize, int maxOutputSize);
 
 /*
 LZ4_compress_limitedOutput() :
@@ -109,7 +125,7 @@
 */
 
 
-int LZ4_uncompress_unknownOutputSize (const char* source, char* dest, int isize, int maxOutputSize);
+ZFASTEXTERN int LZ4_uncompress_unknownOutputSize (const char* source, char* dest, int isize, int maxOutputSize);
 
 /*
 LZ4_uncompress_unknownOutputSize() :
